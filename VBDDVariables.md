# VBDDVariables
*DDVariableStore.DLL* is a **COM** interface. There are several tools that require the *DDVariableStore.DLL*. Primarily, these are tools that cannot call DLL functions directly and thus we provide a COM interface to STAF.

### Main Assets 
Three VB6 projects are available. VB6 is required before opening them.


FILE | PURPOSE
------------ | -------------
README.md                      | This readme file.
DDVariableStore.vbp           | Core project to generate *DDVariableStore.DLL*.
VariablesTest.vbp             | Project to test *DDVariableStore.DLL*(COM) that has been registered in OS.
DDVTestGroup.vbg              | Project group with *DDVariableStore.vbp* and *VariablesTest.vbp* inside. Two sub-projects can work together, and can be used to debug *DDVariableStore.DLL*. <br /> <br /> One thing needs to be done before debugging *DDVariableStore.DLL* - importing the reference of the *DDVariableStore.DLL*, which is generated by *DDVariableStore.vbp* and stays in the same directory with *DDVariableStore.vbp*. <br /> <br /> To do so, select *VariablesTest.vbp* in **DDVTestGroup** in VB6 after you open this project, then choose menu item "**Project->References...**" to pop up a dialogue titled "*References¨CVariablesTest.vbp*". <br /> <br /> Check **DDVariableStore for Automation Frameworks** in Available References, and push "OK".
*.cls                          | Class Modules
*.bas                          | Modules 
TestDDVariableProperties.vbs   | VB Script example to call *DDVariableStore.DLL*.


### Q&A
**1. Is there any command line to build DDVariableStore.DLL**

Yes, by running ```VB6 /make DDVariableStore.vbp```. VB6 compiles *DDVariableStore.vbp* and generate the DLL, using the existing settings stored in the project file.

**2. How to register DDVariableStore.DLL**

*STAFWrap.DLL* is supposed to be in the directory where DDVariableStore.DLL stays. In DOS command line, for example: run ```regsvr32 c:\mypath\DDVariableStore.DLL```.

**3. How to use DDVariableStore.DLL**

*DDVariableStore.DLL* is a COM automation interface. It is easy to be used in different languages.


### Example
One simple example in **wsf** script:
```bat
Set oCollection = CreateObject("DDVariableStore.DDVariables")
oCollection.SetVariableValue "var1", 101

oCollection.GetVariableValue "var1", x
WScript.Echo x
```

**Output**: 101

<br />

<sub>SEP 15, 2009  SAS</sub>
